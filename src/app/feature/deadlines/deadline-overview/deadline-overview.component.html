<div class="calendar-container">
  <div class="calendar">
    <app-calendar [deadlines]="(deadlines$ | async) ?? []"></app-calendar>
  </div>
  <div class="right-sidebar">
    @if ((isTeacher$ | async)) {
      <!-- Changed button click from navigation to opening the modal -->
      <app-button variant="primary" (click)="openCreateModal()">Create Deadline</app-button>
    }
    @if (deadlines$ | async; as deadlines) {
      <div>
        @if (deadlines.length > 0) {
          <div>
            <div class="deadline-container">
              @for (deadline of deadlines; track deadline) {
                <div class="deadline-card">
                  <h3>{{ deadline.title }}</h3>
                  @if ((isTeacher$ | async)) {
                    <span class="delete-icon" (click)="openDeleteModal(deadline)">
                      X
                    </span>
                  }
                  <p class="due-date">
                    {{ convertToTimeZone(deadline.dueDate) | date: 'EEE MMM d' }} at
                    {{ convertToTimeZone(deadline.dueDate) | date: 'HH:mm' }}
                  </p>
                  <p class="description">{{ deadline.description }}</p>
                  <p class="restriction" [ngClass]="deadline.restriction.toLowerCase()">
                    <span class="badge">{{ deadline.restriction.replace('_', ' ').toLowerCase() }}</span>
                  </p>
                </div>
              }
            </div>
          </div>
        } @else {
          <p>No deadlines available.</p>
        }
      </div>
    } @else {
      <p>Loading deadlines...</p>
    }
  </div>
</div>

<!-- Delete Confirmation Modal (remains unchanged) -->
@if (showModal) {
  <div class="modal">
    <div class="modal-content">
      <h2>Delete this Deadline?</h2>
      <div class="modal-actions">
        <app-button variant="danger" (click)="closeModal()">Cancel</app-button>
        <app-button variant="primary" (click)="confirmDelete()">Confirm</app-button>
      </div>
    </div>
  </div>
}

<!-- Create Deadline Modal Overlay -->
@if (showCreateModal) {
  <div class="modal">
    <div class="modal-content">
      <!-- Close button for the modal overlay -->
      <button class="close-button" (click)="closeCreateModal()">X</button>
      <!-- Embed the create deadline component -->
      <app-deadline-create
        (deadlineCreated)="onDeadlineCreated()"
        (closeModal)="closeCreateModal()">
      </app-deadline-create>
    </div>
  </div>
}
