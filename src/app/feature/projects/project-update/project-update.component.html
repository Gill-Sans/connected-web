<div class="update-project-container">
    <h2 class="page-title">Update Project</h2>

    <form [formGroup]="projectForm" (ngSubmit)="onSubmit()" class="update-form">

        @if (canEdit$ | async) {
            <!-- Title -->
            <div class="form-group">
                <label for="title">Title</label>
                <p class="field-description">
                    The title of your project should be a short, inviting sentence that describes your project.
                </p>
                <input id="title" type="text" formControlName="title" placeholder="Title of your project" />
                @if (projectForm.get('title')?.invalid && projectForm.get('title')?.touched) {
                    <div class="error-message">
                        @if (projectForm.get('title')?.errors?.['required']) { Title is required. }
                        @if (projectForm.get('title')?.errors?.['maxLength']) { Title cannot exceed 255 characters. }
                    </div>
                }
            </div>

            <!-- Short Description -->
            <div class="form-group">
                <label for="shortDescription">Short Description</label>
                <p class="field-description">
                    Describe your project. ({{ charCount }}/280 characters)
                </p>
                <textarea
                    id="shortDescription"
                    rows="7"
                    maxlength="280"
                    formControlName="shortDescription"
                    placeholder="Short description of your project"
                    (input)="updateCharCount()"
                ></textarea>

                @if (projectForm.get('shortDescription')?.invalid && projectForm.get('shortDescription')?.touched) {
                    <div class="error-message">
                        @if (projectForm.get('shortDescription')?.errors?.['required']) { Short description is required. }
                        @if (projectForm.get('shortDescription')?.errors?.['maxLength']) { Short description cannot exceed 280 characters. }
                    </div>
                }
            </div>

            <!-- Description -->
            <div class="form-group">
                <label for="description">Project Description</label>
                <p class="field-description">Describe your project in detail.</p>
                <app-md-editor [form]="projectForm" controlName="description"></app-md-editor>

                @if (projectForm.get('description')?.invalid && projectForm.get('description')?.touched) {
                    <div class="error-message">
                        @if (projectForm.get('description')?.errors?.['required']) { Project description is required. }
                        @if (projectForm.get('description')?.errors?.['minLength']) {
                            Project description must contain at least 250 characters.
                        }
                    </div>
                }
            </div>

            <!-- Team Size -->
            <div class="form-group">
                <label for="teamSize">Team Size</label>
                <p class="field-description">
                    If no team size is given, the default assignment size will be applied.
                </p>
                <input id="teamSize" type="number" min="1" formControlName="teamSize" />
            </div>
        }

        <!-- Repository -->
        <div class="form-group">
            <label for="repositoryUrl">Repository URL</label>
            <input id="repositoryUrl" type="text" formControlName="repositoryUrl" placeholder="https://github.com/my-repo" />
        </div>

        <!-- Board -->
        <div class="form-group">
            <label for="boardUrl">Board URL</label>
            <input id="boardUrl" type="text" formControlName="boardUrl" placeholder="https://trello.com/my-board" />
        </div>

        <!-- Tags -->
        <div class="form-group">
            <label>Skillset</label>
            <div class="tags-container">
                @for (tag of tagList; track tag) {
                    <app-tagcard [tag]="tag" [showDelete]="true" (deleteTag)="removeTag(tag.id)"></app-tagcard>
                }
            </div>
            <app-tag-search-component (tagSelected)="addTagToProject($event)"></app-tag-search-component>

            @if (projectForm.get('tags')?.invalid && projectForm.get('tags')?.touched) {
                <div class="error-message">Please add at least one tag.</div>
            }
        </div>

        <!-- SUBMIT -->
        <app-button type="submit">Update Project</app-button>

    </form>
</div>
