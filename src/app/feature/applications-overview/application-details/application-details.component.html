<!-- Action Modal -->
@if (showActionModal) {
  <app-confirmation-modal
    [title]="selectedAction === 'approve' ? 'Approve Application' : 'Reject Application'"
    [message]="'Are you sure you want to do this action?'"
    [confirmText]="selectedAction === 'approve' ? 'Approve' : 'Reject'"
    [cancelText]="'Cancel'"
    (confirm)="handleActionConfirm()"
    (cancel)="closeActionModal()">
  </app-confirmation-modal>
}

<div class="application-details-container">
  @if (application$ | async; as application) {
    <div class="content-wrapper">
      <!-- Left side - Motivation -->
      <div class="motivation-section">
        <h2>Motivation</h2>
        <div class="motivation-content">
          <div class="rich-content" [innerHTML]="application.motivationMd"></div>
        </div>
      </div>
      <!-- Right side - Applicant Details -->
      <div class="applicant-section">
        @if ((isOwner$ | async) && (application.status == ApplicationStatusEnum.PENDING)) {
          <div class="action-container">
            <h4>Manage Application</h4>
            <div class="action-buttons">
              <app-button variant="success" (click)="openActionModal(application.id, 'approve')">Approve</app-button>
              <app-button variant="danger" (click)="openActionModal(application.id, 'reject')">Reject</app-button>
            </div>
          </div>
        }
        @if ((isApplicationOwner$ | async) && (application.status == ApplicationStatusEnum.APPROVED) && !(isMember$ | async)) {
          <div class="action-container">
            <app-button variant="primary" (click)="joinProject(application.id)">Join Project</app-button>
          </div>
        }
        <div class="details-section">
          <h2>Applicant Details</h2>
          <div class="details-content">
            <div class="detail-item">
              <label>Applicant</label>
              <p>{{ application.applicant.firstName }} {{ application.applicant.lastName }}</p>
            </div>
            <div class="detail-item">
              <label>Status</label>
              <app-statuscard [status]="application.status.toString()"></app-statuscard>
            </div>
            <div class="detail-item">
              <label>Project</label>
              <p class="project-title" (click)="navigateToProject()">{{ application.project.title }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  }
</div>
